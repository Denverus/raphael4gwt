/*! raphael4gwt 2013-08-26 */
function raphalytics(a,b,c,d,e){function f(a,b,c,d,e,f){var g=(c-a)/2,h=(e-c)/2,i=Math.atan((c-a)/Math.abs(d-b)),j=Math.atan((e-c)/Math.abs(d-f));i=d>b?Math.PI-i:i,j=d>f?Math.PI-j:j;var k=Math.PI/2-(i+j)%(2*Math.PI)/2,l=g*Math.sin(k+i),m=g*Math.cos(k+i),n=h*Math.sin(k+j),o=h*Math.cos(k+j);return{x1:c-l,y1:d+m,x2:c+n,y2:d+o}}"object"!=typeof b[0]&&(b=[b]),"object"!=typeof d[0]&&(d=[d]);var g=Math.max.apply(Math,b[0]);for(U=0,V=b.length;V>U;U++)Math.max.apply(Math,b[U])>g&&(g=Math.max.apply(Math,b[U]));var h=e.width||750,i=e.height||150,j=e.leftgutter||10,k=e.bottomgutter||16,l=e.topgutter||14,m=e.rightgutter||10,n=e.normalize||!0,o=e.smooth||!1,p=e.fill||!1,q=e.gridtype||"minimalist",r=e.gridcolor||"#ccc",s=e.gridbordertype||("minimalist"==q?"minimalist":"full"),u=e.gridbordercolor||("minimalist"==q?"#000":"#ccc"),v=e.color||"#2F69BF",w=e.tooltipcolor||"#000",x=e.tooltipbordercolor||"#666",y=e.tooltiptextcolor||"#fff",z=e.labelcolor||"#000",A=e.y_labels_number||2,B=e.y_label_0||!1,C=e.y_labels_position||"inside",D={font:"12px Helvetica, Arial",fill:"#fff"};if(A>g&&(g=A),n&&(g=Math.ceil(4*g/3),g>10)){var E=Math.pow(10,g.toString().length-1);g=Math.ceil(g/E)*E}"outside"==C&&j<8*g.toString().length&&(j=8*g.toString().length);var F=(h-j-m)/(c.length-1),G=(i-k-l)/g;a.drawGridBorder(j,l,h-j-m,i-l-k,s,u),a.drawGrid(j,l,h-j-m,i-l-k,c.length-1,A,q,r),"object"!=typeof v&&(v=[v]);var H,I,J,K,L,M,N=a.set(),O=0,P=0,Q=!1,R=a.set();N.push(a.text(60,12,d[0][0]).attr(D).attr({fill:y})),N.hide(),a.frame=a.raphalytics_popup(100,100,N,"right").attr({fill:w,stroke:x,"stroke-width":2,"fill-opacity":.7}).hide();for(var S=0,T=b.length;T>S;S++){M="undefined"==typeof v[S]?v[v.length-1]:v[S],H=a.path().attr({stroke:M,"stroke-width":4,"stroke-linejoin":"round"}),p&&(I=a.path().attr({stroke:"none",opacity:.3,fill:M})),J=null,K=null;for(var U=0,V=c.length;V>U;U++){var W=Math.round(i-k-G*b[S][U]),X=Math.round(j+F*U);if(U||(J=o?["M",X,W,"C",X,W]:["M",X,W,"L",X,W],p&&(K=o?["M",j,i-k,"L",X,W,"C",X,W]:["M",j,i-k,"L",X,W,"L",X,W])),U&&V-1>U){var Y=Math.round(i-k-G*b[S][U-1]),Z=Math.round(j+F*U),$=Math.round(i-k-G*b[S][U+1]),_=Math.round(j+F*(U+1)),ab=f(Z,Y,X,W,_,$);J=o?J.concat([ab.x1,ab.y1,X,W,ab.x2,ab.y2]):J.concat([X,W]),p&&(K=o?K.concat([ab.x1,ab.y1,X,W,ab.x2,ab.y2]):K.concat([X,W]))}var bb=a.circle(X,W,4).attr({fill:M,stroke:M,"stroke-width":2});if("object"==typeof d[S]&&"undefined"!=typeof d[S][U]&&0!=d[S][U]){R.push(a.rect(X-10,W-10,20,20).attr({stroke:"none",fill:"#fff",opacity:0}));var cb=R[R.length-1];!function(b,c,d,e,f,g){cb.hover(function(){clearTimeout(L);var b="right";c+a.frame.getBBox().width>h&&(b="left");var e=a.raphalytics_popup(c,d,N,b,1),i=Raphael.animation({path:e.path,transform:["t",e.dx,e.dy]},200*Q);O=N[0].transform()[0][1]+e.dx,P=N[0].transform()[0][2]+e.dy,a.frame.show().stop().animate(i),N[0].attr({text:f}).show().stop().animateWith(a.frame,i,{transform:["t",O,P]},200*Q),g.attr("r",6),Q=!0},function(){g.attr("r",4),L=setTimeout(function(){a.frame.hide(),N[0].hide(),Q=!1},1e3)})}(S,X,W,b[S][U],d[S][U],bb)}}J=o?J.concat([X,W,X,W]):J.concat([X,W]),H.attr({path:J}),p&&(K=o?K.concat([X,W,X,W,"L",X,i-k,"z"]):K.concat([X,W,X,i-k,"z"]),I.attr({path:K}))}var db=B?0:1,eb=0,fb="outside"==C?"end":"start";for(U=db;A>=U;U++){eb=Math.round(U*g/A),eb=eb.toString();var gb="outside"==C?j-1:j+1,hb="outside"==C?i-k-U*Math.round((i-l-k)/A):0==U?i-k-U*Math.round((i-l-k)/A)-8:i-k-U*Math.round((i-l-k)/A)+8;a.text(gb,hb,eb).attr(D).attr({fill:"white",stroke:"#fff","stroke-width":2,"text-anchor":fb}).toFront(),a.text(gb,hb,eb).attr(D).attr({fill:z,"text-anchor":fb}).toFront()}for(var U=0,V=c.length;V>U;U++)if(c[U]){var X=Math.round(j+F*U),ib=0==U?"start":U==V-1?"end":"middle";t=a.text(X,i-6,c[U]).attr(D).attr({fill:z,"text-anchor":ib}).toBack()}a.frame.toFront(),N[0].toFront(),R.toFront()}!function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),"function"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+""},d=function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})};Raphael.fn.raphalytics_popup=function(a,b,c,e,f){e=String(e||"top-middle").split("-"),e[1]=e[1]||"middle";var g=5,h=c.getBBox(),i=Math.round(h.width),j=Math.round(h.height),k=Math.round(h.x)-g,l=Math.round(h.y)-g,m=Math.min(j/2,i/2,10),n={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"},o=[{x:k+g,y:l,w:i,w4:i/4,h4:j/4,right:0,left:i-2*m,bottom:0,top:j-2*m,r:g,h:j,gap:m},{x:k+g,y:l,w:i,w4:i/4,h4:j/4,left:i/2-m,right:i/2-m,top:j/2-m,bottom:j/2-m,r:g,h:j,gap:m},{x:k+g,y:l,w:i,w4:i/4,h4:j/4,left:0,right:i-2*m,top:0,bottom:j-2*m,r:g,h:j,gap:m}]["middle"==e[1]?1:2*("top"==e[1]||"left"==e[1])],p=0,q=0,r=this.path(d(n[e[0]],o)).insertBefore(c);switch(e[0]){case"top":p=a-(k+g+o.left+m),q=b-(l+g+j+g+m);break;case"bottom":p=a-(k+g+o.left+m),q=b-(l-m);break;case"left":p=a-(k+g+i+g+m),q=b-(l+g+o.top+m);break;case"right":p=a-(k-m),q=b-(l+g+o.top+m)}return r.translate(p,q),f?(f=r.attr("path"),r.remove(),{path:f,dx:p,dy:q}):(c.translate(p,q),r)}}(),Raphael.fn.drawGridBorder=function(a,b,c,d,e,f){if("full"==e)var g=["M",Math.round(a),Math.round(b),"L",Math.round(a+c),Math.round(b),Math.round(a+c),Math.round(b+d),Math.round(a),Math.round(b+d),Math.round(a),Math.round(b)];if("xoy"==e)var g=["M",Math.round(a),Math.round(b+d),"L",Math.round(a+c),Math.round(b+d),"M",Math.round(a),Math.round(b+d),"L",Math.round(a),Math.round(b)];if("minimalist"==e)var g=["M",Math.round(a),Math.round(b+d),"L",Math.round(a+c),Math.round(b+d)];return this.path(g.join(",")).attr({stroke:f,"stroke-width":.5})},Raphael.fn.drawGrid=function(a,b,c,d,e,f,g,h){var i=[],j=d/f,k=c/e;if("y_grid"==g||"full_grid"==g||"minimalist"==g)for(var l="minimalist"==g?0:1,m=l;f>m;m++)i=i.concat(["M",Math.round(a),Math.round(b+m*j),"H",Math.round(a+c)]);if("x_grid"==g||"full_grid"==g)for(m=1;e>m;m++)i=i.concat(["M",Math.round(a+m*k),Math.round(b),"V",Math.round(b+d)]);return this.path(i.join(",")).attr({stroke:h,"stroke-width":.5})},Raphael.fn.raphalytics=function(a,b,c,d){return new raphalytics(this,a,b,c,d)};